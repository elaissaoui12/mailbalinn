"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["5326"],{84075:function(e,t,a){a.d(t,{WH:()=>r,hI:()=>o,iE:()=>p,mD:()=>c,sS:()=>n,uz:()=>v,vi:()=>d,yG:()=>m,yL:()=>u});var s=a(76882),l=a(34541);let{t:i}=s.Z.global,o=e=>l.e.get("/contact/group/list",{params:e}),r=()=>l.e.get("/contact/group/all"),u=e=>l.e.get("/contact/group/info",{params:e}),n=e=>l.e.post("/contact/group/create",e,{fetchOptions:{loading:i("contacts.group.loading.createGroup"),successMessage:!0}}),c=e=>l.e.post("/contact/group/update",e,{fetchOptions:{loading:i("contacts.group.loading.updateGroup"),successMessage:!0}}),p=e=>l.e.post("/contact/group/delete",e,{fetchOptions:{loading:i("contacts.group.loading.deleteGroup"),successMessage:!0}}),d=e=>l.e.post("/contact/group/contact_count",e),m=e=>l.e.post("/contact/group/export",e,{fetchOptions:{loading:i("contacts.group.loading.exportGroup"),successMessage:!0}}),v=e=>l.e.post("/contact/group/update",e,{fetchOptions:{loading:i("contacts.group.loading.saveSettings"),successMessage:!0}})},80947:function(e,t,a){a.d(t,{N:()=>o});var s=a(22895),l=a(68271),i=a(58786);let o=e=>{let{params:t,fetchFn:a,useParams:o,loading:r=!0,immediate:u=!0,rowKey:n=e=>e.id}=e,c=(0,i.iH)(r),p=(0,i.iH)([]),d=(0,i.iH)(0),m=(0,i.iH)(t),v=(0,i.iH)([]),b=()=>o?o(m.value):m.value,g=(0,s.DI)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(m.value.page=1),c.value=!0;try{let e=b(),t=await a(e);(0,l.Kn)(t)&&(p.value=(0,l.kJ)(t.list)?t.list:[],d.value=(0,l.hj)(t.total)?t.total:0)}finally{v.value=[],c.value=!1}},300),f=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return g(e)},_=e=>{m.value.page=e},w=e=>{m.value.page_size=e};return(0,i.bv)(()=>{u&&f()}),{tableData:p,tableTotal:d,tableKeys:v,tableParams:m,fetchTable:f,resetTable:()=>f(!0),tableProps:(0,i.Fl)(()=>({rowKey:n,data:p.value,loading:c.value,checkedRowKeys:v.value,onUpdateCheckedRowKeys:e=>{v.value=e}})),batchProps:(0,i.Fl)(()=>({rowKey:n,data:p.value,checkedRowKeys:v.value,onUpdateCheckedRowKeys:e=>{v.value=e}})),pageProps:(0,i.Fl)(()=>({page:m.value.page,pageSize:m.value.page_size,itemCount:d.value,onUpdatePage:_,onUpdatePageSize:w}))}}},83077:function(e,t,a){a.d(t,{Z:()=>b});var s=a(58786),l=a(70392),i=a(82994),o=a(68449),r=a(90838),u=a(14863),n=a(72632),c=a(95691),p=a(58964),d=a(65391),m=a(45334),v=a(62635);let b={__name:"index",props:{options:{type:Object,required:!0},height:{type:[String,Number],default:"100%"},theme:{type:String,default:"default"},notMerge:{type:Boolean,default:!1},lazyUpdate:{type:Boolean,default:!1}},setup(e,t){let{expose:a}=t;l.D([u.N,n.N,c.N,p.N,d.N,m.N,o.N,r.N,v.N]);let b=(0,s.iH)(null),g=(0,s.Fl)(()=>"number"==typeof e.height?`${e.height}px`:e.height),f=null,_=null,w=()=>{b.value&&(f=i.S1(b.value,e.theme,{renderer:"canvas",useDirtyRect:!0}),h(),(_=new ResizeObserver(()=>{requestAnimationFrame(()=>{null==f||f.resize()})})).observe(b.value))},h=()=>{f&&e.options&&f.setOption(e.options,{notMerge:e.notMerge,lazyUpdate:e.lazyUpdate})};return(0,s.bv)(()=>{w()}),(0,s.SK)(()=>{null==_||_.disconnect(),f&&(f.dispose(),f=null)}),(0,s.YP)(()=>e.options,()=>{h()},{deep:!0}),(0,s.YP)(()=>e.theme,()=>{f&&(f.dispose(),w())}),a({getChartInstance:()=>f,resize:()=>null==f?void 0:f.resize()}),(e,t)=>((0,s.wg)(),(0,s.iD)("div",{ref_key:"chartRef",ref:b,style:(0,s.j5)({width:"100%",height:(0,s.SU)(g)})},null,4))}}},86559:function(e,t,a){a.d(t,{Z:()=>i});var s=a(73084),l=a(58786);let i=(0,l.aZ)({__name:"index",props:(0,l.Vf)({width:{default:240},prefix:{type:Boolean,default:!1}},{value:{default:""},valueModifiers:{}}),emits:(0,l.Vf)(["search"],["update:value"]),setup(e,t){let{expose:a,emit:i}=t,o=(0,l.iH)(null),r=(0,l.tT)(e,"value"),u=()=>{i("search",r.value)};return a({focus:()=>{var e;null==(e=o.value)||e.focus()}}),(e,t)=>{let a=s.Z;return(0,l.wg)(),(0,l.j4)(a,(0,l.dG)({ref_key:"inputRef",ref:o,value:r.value,"onUpdate:value":t[0]||(t[0]=e=>r.value=e)},e.$attrs,{class:"bt-search",style:{width:`${e.width}px`},onKeyup:(0,l.D2)(u,["enter"])}),(0,l.Nv)({_:2},[e.prefix?{name:"prefix",fn:(0,l.w5)(()=>[(0,l._)("div",{class:"flex items-center cursor-pointer",onClick:u},t[1]||(t[1]=[(0,l._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"0"}:void 0,e.prefix?void 0:{name:"suffix",fn:(0,l.w5)(()=>[(0,l._)("div",{class:"flex items-center cursor-pointer",onClick:u},t[2]||(t[2]=[(0,l._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"1"}]),1040,["value","style"])}}})},66760:function(e,t,a){a.d(t,{Z:()=>r});var s=a(81021),l=a(15496),i=a(58786);let o={class:"leading-22px text-13px text-desc text-center"},r=(0,i.aZ)({__name:"index",setup(e){let t=()=>{window.open("https://github.com/aaPanel/BillionMail/issues")},a=()=>{window.open("https://github.com/aaPanel/BillionMail")};return(e,r)=>{let u=l.ZP,n=(0,i.up)("i18n-t"),c=s.Z;return(0,i.wg)(),(0,i.j4)(c,null,{default:(0,i.w5)(()=>[(0,i._)("div",o,[(0,i.Wm)(n,{tag:"span",scope:"global",keypath:"components.tableHelp.text1"},{issues:(0,i.w5)(()=>[(0,i.Wm)(u,{class:"text-13px",type:"primary",text:"",onClick:t},{default:(0,i.w5)(()=>r[0]||(r[0]=[(0,i._)("span",null,"Issues",-1),(0,i._)("i",{class:"i-mdi:arrow-right ml-1px"},null,-1)])),_:1,__:[0]})]),star:(0,i.w5)(()=>[(0,i.Wm)(u,{class:"text-13px",type:"primary",text:"",onClick:a},{default:(0,i.w5)(()=>r[1]||(r[1]=[(0,i.Uk)(" Star "),(0,i._)("i",{class:"i-mdi:arrow-right ml-1px"},null,-1)])),_:1,__:[1]})]),_:1}),r[2]||(r[2]=(0,i._)("br",null,null,-1)),(0,i._)("span",null,(0,i.zw)(e.$t("components.tableHelp.text2")),1)])]),_:1})}}})},39244:function(e,t,a){a.d(t,{Z:()=>i});var s=a(93953),l=a(58786);let i=(0,l.aZ)({__name:"index",setup(e){let t=!!(0,l.Rr)().toolsLeft,a=!!(0,l.Rr)().toolsRight,i=!!(0,l.Rr)().pageLeft||!!(0,l.Rr)().pageRight;return(e,o)=>{let r=s.Z;return(0,l.wg)(),(0,l.iD)("div",null,[t||a?((0,l.wg)(),(0,l.j4)(r,{key:0,class:"items-center mb-12px",justify:"space-between"},{default:(0,l.w5)(()=>[(0,l.Wm)(r,{class:"items-center",size:12},{default:(0,l.w5)(()=>[(0,l.WI)(e.$slots,"toolsLeft")]),_:3}),(0,l.Wm)(r,{class:"items-center",size:12},{default:(0,l.w5)(()=>[(0,l.WI)(e.$slots,"toolsRight")]),_:3})]),_:3})):(0,l.kq)("",!0),(0,l.WI)(e.$slots,"table"),(0,l.SU)(i)?((0,l.wg)(),(0,l.j4)(r,{key:1,class:"items-center mt-12px",justify:"space-between"},{default:(0,l.w5)(()=>[(0,l._)("div",null,[(0,l.WI)(e.$slots,"pageLeft")]),(0,l.Wm)(r,null,{default:(0,l.w5)(()=>[(0,l.WI)(e.$slots,"pageRight")]),_:3})]),_:3})):(0,l.kq)("",!0),(0,l.WI)(e.$slots,"modal")])}}})},25170:function(e,t,a){a.d(t,{Z:()=>r});var s=a(75459),l=a(58786),i=a(68271);let o={class:"ml-8px text-14px"},r=(0,l.aZ)({__name:"index",props:(0,l.Vf)({storeKey:{default:""},pageSizes:{default:()=>[10,20,50,100]},showTotal:{type:Boolean,default:!0},showSizePicker:{type:Boolean,default:!0},showQuickJumper:{type:Boolean,default:!0},onUpdatePage:{}},{page:{},pageModifiers:{},pageSize:{},pageSizeModifiers:{}}),emits:(0,l.Vf)(["refresh"],["update:page","update:pageSize"]),setup(e,t){let{emit:a}=t,r=(0,l.Fl)(()=>{let{storeKey:t}=e;return t?`${t}-page`:""}),u=(0,l.tT)(e,"page"),n=(0,l.tT)(e,"pageSize"),c=t=>{var s;null==(s=e.onUpdatePage)||s.call(e,t),a("refresh")},p=t=>{var s;u.value=1,null==(s=e.onUpdatePage)||s.call(e,1),d(t),a("refresh")},d=e=>{r.value&&(0,i.qQ)(r.value,String(e))};if(r.value){let e=(0,i.$o)(r.value);e&&(n.value=(0,i.Dx)(e))}return(e,t)=>{let a=s.Z;return(0,l.wg)(),(0,l.j4)(a,(0,l.dG)(e.$attrs,{page:u.value,"onUpdate:page":[t[0]||(t[0]=e=>u.value=e),c],"page-size":n.value,"onUpdate:pageSize":[t[1]||(t[1]=e=>n.value=e),p],"show-size-picker":e.showSizePicker,"show-quick-jumper":e.showQuickJumper,"page-sizes":e.pageSizes,"display-order":["pages","size-picker","quick-jumper"]}),(0,l.Nv)({_:2},[e.showTotal?{name:"suffix",fn:(0,l.w5)(e=>{let{itemCount:t}=e;return[(0,l._)("span",o," Total "+(0,l.zw)(t),1)]}),key:"0"}:void 0]),1040,["page","page-size","show-size-picker","show-quick-jumper","page-sizes"])}}})},79430:function(e,t,a){a.r(t),a.d(t,{default:()=>er});var s=a(39244),l=a(25170),i=a(60424),o=a(66760),r=a(86559),u=a(16715),n=a(77227),c=a(58786),p=a(94821),d=a(53903),m=a(93953),v=a(15496),b=a(68271),g=a(51169),f=a(80947),_=a(34541);let{t:w}=a(76882).Z.global,h=e=>_.e.get("/contact/list_ndp",{params:e}),S=e=>_.e.get("/contact/trend",{params:e}),y=e=>_.e.post("/contact/group/import",e,{fetchOptions:{loading:w("contacts.subscribers.loading.importSubscribers"),successMessage:!0}}),U=e=>_.e.post("/contact/edit_ndp",e,{fetchOptions:{loading:w("contacts.subscribers.loading.updateSubscriberGroup"),successMessage:!0}}),x=e=>_.e.post("/contact/delete_ndp",e,{fetchOptions:{loading:w("contacts.subscribers.loading.deleteSubscriber"),successMessage:!0}});var W=a(8490),k=a(84075),Z=a(52495);let z=(0,c.aZ)({__name:"GroupSelect",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){let{t}=(0,Z.QT)(),a=(0,c.tT)(e,"value"),s=(0,c.iH)([{label:t("common.all.text"),value:0}]),l=e=>{let{option:a}=e;return`${t("contacts.subscribers.select.prefix")}${a.label}`};return(async()=>{let e=await (0,k.WH)();(0,b.Kn)(e)&&(s.value=e.list.map(e=>({label:e.name,value:e.id})),s.value.unshift({label:t("common.all.text"),value:0}))})(),(e,t)=>{let i=W.Z;return(0,c.wg)(),(0,c.j4)(i,{value:a.value,"onUpdate:value":t[0]||(t[0]=e=>a.value=e),options:(0,c.SU)(s),renderTag:l},null,8,["value","options"])}}});var $=a(60579),R=a(83077);let P={class:"text-center fw-bold text-16px text-default"},O={class:"w-96% h-160px mx-auto"},j=(0,c.aZ)({__name:"SubscriberTrends",props:{groupId:{type:Number}},setup(e,t){let{expose:a}=t,s=(0,c.iH)(!1),l=(0,c.iH)([]),{t:i}=(0,Z.QT)(),o=(0,c.Fl)(()=>({tooltip:{trigger:"axis",order:"seriesDesc",axisPointer:{type:"shadow"}},grid:{top:"16%",left:"2%",right:"2%",bottom:"4%",containLabel:!0},xAxis:{data:l.value.map(e=>e.month),axisTick:{show:!1},axisLabel:{color:"#6b7280",fontSize:12}},yAxis:{type:"value",minInterval:1,axisLabel:{color:"#6b7280",fontSize:12}},series:[{name:i("contacts.subscribers.trends.subscriber"),type:"line",data:l.value.map(e=>e.count),itemStyle:{color:"#20a53a"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.4)"},{offset:.7,color:"rgba(32, 164, 58, 0)"}]}}}]})),r=async()=>{try{s.value=!0;let t=await S({group_id:e.groupId});(0,b.Kn)(t)&&(l.value=(0,b.kJ)(t.subscribe)?t.subscribe:[])}finally{s.value=!1}};return r(),a({getData:r}),(e,t)=>{let a=R.Z,l=$.Z;return(0,c.wg)(),(0,c.j4)(l,{class:"mb-16px",show:(0,c.SU)(s)},{default:(0,c.w5)(()=>[(0,c._)("div",P,(0,c.zw)((0,c.SU)(i)("contacts.subscribers.trends.title")),1),(0,c._)("div",O,[(0,c.Wm)(a,{options:(0,c.SU)(o)},null,8,["options"])])]),_:1},8,["show"])}}});var C=a(46244),H=a(73084),T=a(3179),M=a(81833),I=a(37864),N=a(6455),q=a(46471),D=a(98003);let G=(0,c.aZ)({__name:"GroupMultipleSelect",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){let t=(0,c.tT)(e,"value"),a=(0,c.iH)([]),s=(0,c.iH)(!1);return(async()=>{try{s.value=!0;let e=await (0,k.WH)();(0,b.Kn)(e)&&(a.value=e.list.map(e=>({label:e.name,value:e.id})))}finally{s.value=!1}})(),(e,l)=>{let i=W.Z;return(0,c.wg)(),(0,c.j4)(i,{value:t.value,"onUpdate:value":l[0]||(l[0]=e=>t.value=e),"max-tag-count":"responsive",multiple:!0,filterable:!0,loading:(0,c.SU)(s),options:(0,c.SU)(a)},null,8,["value","loading","options"])}}}),F={class:"pt-12px"},L={class:"flex-1"},K={class:"mb-8px text-desc"},A={class:"w-260px"},B={class:"flex-1"},E={class:"mt-8px"},Q={class:"mt-8px text-12px text-desc"},J={class:"mt-8px text-12px text-desc"},X=`email,attributes
example1@example.com,"{""age"": ""13"", ""Gender"": ""XXX""}"
example2@example.com,"{""age"": ""45"", ""city"": ""XXX""}"
`,Y=(0,c.aZ)({__name:"SubscriberImport",setup(e){let{t}=(0,Z.QT)(),a=(0,c.AE)("formRef"),s=(0,c.iH)("paste"),l=(0,c.qj)({group_ids:[],import_type:1,contacts:"",file_data:"",file_type:"",overwrite:0,default_active:1,status:1}),i={group_ids:{trigger:"change",validator:()=>0!==l.group_ids.length||Error(t("contacts.subscribers.import.validation.groupRequired"))},contacts:{validator:()=>!(2===l.import_type&&(0,q.Z)(l.contacts))||Error(t("contacts.subscribers.import.validation.dataRequired"))}},o=(0,c.Fl)(()=>[{label:t("contacts.subscribers.import.overwriteOptions.no"),value:0},{label:t("contacts.subscribers.import.overwriteOptions.yes"),value:1}]),r=(0,c.Fl)(()=>[{label:t("contacts.subscribers.import.subscriptionOptions.subscribe"),value:1},{label:t("contacts.subscribers.import.subscriptionOptions.unsubscribe"),value:0}]),p=(0,c.Fl)(()=>[{label:t("contacts.subscribers.import.statusOptions.confirmed"),value:1},{label:t("contacts.subscribers.import.statusOptions.unconfirmed"),value:0}]),d=e=>{let t=new FileReader;t.onload=t=>{var a;l.file_type=e.name.substring(e.name.lastIndexOf(".")+1),l.file_data=null==(a=t.target)?void 0:a.result},e.file&&t.readAsText(e.file)},m=async()=>{await (0,D.Sv)({file_path:"./template/example_recipients.csv"})},f=async()=>{var e;if(await (null==(e=a.value)?void 0:e.validate()),"upload"===s.value&&(0,q.Z)(l.file_data))return b.v0.error(t("contacts.subscribers.import.validation.fileRequired")),Promise.reject()},[_,w]=(0,g.d)({onChangeState:e=>{if(e){let e=w.getState();(null==e?void 0:e.group_id)?l.group_ids=[e.group_id]:l.group_ids=[]}else l.import_type=1,l.contacts="",l.file_data="",l.file_type="",l.group_ids=[],l.overwrite=0,l.default_active=1,l.status=1},onConfirm:async()=>{await f(),await y((0,c.IU)(l));let e=w.getState();null==e||e.refresh()}});return(e,t)=>{let s=W.Z,b=N.ZP,g=I.ZP,f=M.Z,w=n.Z,h=u.Z,S=T.Z,y=v.ZP,U=H.Z,x=C.Z;return(0,c.wg)(),(0,c.j4)((0,c.SU)(_),{title:e.$t("contacts.subscribers.import.title"),width:"640"},{default:(0,c.w5)(()=>[(0,c._)("div",F,[(0,c.Wm)(x,{ref_key:"formRef",ref:a,model:(0,c.SU)(l),rules:i},{default:(0,c.w5)(()=>[(0,c.Wm)(b,{label:e.$t("contacts.subscribers.import.overwriteLabel")},{default:(0,c.w5)(()=>[(0,c._)("div",L,[(0,c._)("div",K,(0,c.zw)(e.$t("contacts.subscribers.import.overwriteDescription")),1),(0,c._)("div",A,[(0,c.Wm)(s,{value:(0,c.SU)(l).overwrite,"onUpdate:value":t[0]||(t[0]=e=>(0,c.SU)(l).overwrite=e),options:(0,c.SU)(o)},null,8,["value","options"])])])]),_:1},8,["label"]),(0,c.Wm)(f,{cols:2,"x-gap":24},{default:(0,c.w5)(()=>[(0,c.Wm)(g,{span:1,label:e.$t("contacts.subscribers.import.subscriptionStatus")},{default:(0,c.w5)(()=>[(0,c.Wm)(s,{value:(0,c.SU)(l).default_active,"onUpdate:value":t[1]||(t[1]=e=>(0,c.SU)(l).default_active=e),options:(0,c.SU)(r)},null,8,["value","options"])]),_:1},8,["label"]),(0,c.Wm)(g,{span:1,label:e.$t("contacts.subscribers.import.status")},{default:(0,c.w5)(()=>[(0,c.Wm)(s,{value:(0,c.SU)(l).status,"onUpdate:value":t[2]||(t[2]=e=>(0,c.SU)(l).status=e),options:(0,c.SU)(p)},null,8,["value","options"])]),_:1},8,["label"])]),_:1}),(0,c.Wm)(b,{label:e.$t("contacts.subscribers.import.group"),path:"group_id"},{default:(0,c.w5)(()=>[(0,c.Wm)(G,{value:(0,c.SU)(l).group_ids,"onUpdate:value":t[3]||(t[3]=e=>(0,c.SU)(l).group_ids=e)},null,8,["value"])]),_:1},8,["label"]),(0,c.Wm)(b,{label:e.$t("contacts.subscribers.import.data"),path:"contacts"},{default:(0,c.w5)(()=>[(0,c._)("div",B,[(0,c.Wm)(h,{value:(0,c.SU)(l).import_type,"onUpdate:value":t[4]||(t[4]=e=>(0,c.SU)(l).import_type=e)},{default:(0,c.w5)(()=>[(0,c.Wm)(w,{value:1},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)(e.$t("contacts.subscribers.import.uploadFile")),1)]),_:1}),(0,c.Wm)(w,{value:2},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)(e.$t("contacts.subscribers.import.pasteData")),1)]),_:1})]),_:1},8,["value"]),(0,c._)("div",E,[1===(0,c.SU)(l).import_type?((0,c.wg)(),(0,c.iD)(c.HY,{key:0},[(0,c.Wm)(S,{"is-upload":!1,accept:["csv"],onChange:d}),(0,c._)("div",Q,[(0,c.Uk)((0,c.zw)(e.$t("contacts.subscribers.import.fileTypeHint"))+" ",1),(0,c.Wm)(y,{text:"",type:"primary",onClick:m},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)(e.$t("common.actions.download")),1)]),_:1})])],64)):(0,c.kq)("",!0),2===(0,c.SU)(l).import_type?((0,c.wg)(),(0,c.iD)(c.HY,{key:1},[(0,c.Wm)(U,{value:(0,c.SU)(l).contacts,"onUpdate:value":t[5]||(t[5]=e=>(0,c.SU)(l).contacts=e),type:"textarea",rows:8},null,8,["value"]),(0,c._)("div",J,[(0,c._)("p",null,(0,c.zw)(e.$t("contacts.subscribers.import.pastePlaceholder.0")),1)])],64)):(0,c.kq)("",!0)])])]),_:1},8,["label"]),(0,c.Wm)(b,{label:e.$t("contacts.subscribers.import.exampleCsvLabel")},{default:(0,c.w5)(()=>[(0,c._)("pre",{class:"csv-example"},(0,c.zw)(X))]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}});var V=a(41748);let ee=(0,V.default)(Y,[["__scopeId","data-v-517af80a"]]),et={class:"pt-12px"},ea=(0,c.aZ)({__name:"SubscriberEdit",setup(e){let{t}=(0,Z.QT)(),a=(0,c.AE)("formRef"),s=(0,c.qj)({id:0,email:"",active:1,status:1,attribs:"",group_ids:[]}),l={group_ids:{trigger:"change",validator:()=>0!==s.group_ids.length||Error(t("contacts.subscribers.edit.validation.groupRequired"))}},i=(0,c.Fl)(()=>[{label:t("contacts.subscribers.edit.statusOptions.subscribe"),value:1},{label:t("contacts.subscribers.edit.statusOptions.unsubscribe"),value:0}]),o=(0,c.Fl)(()=>[{label:t("contacts.subscribers.import.statusOptions.confirmed"),value:1},{label:t("contacts.subscribers.import.statusOptions.unconfirmed"),value:0}]),[r,u]=(0,g.d)({onChangeState:e=>{if(e){let{row:e}=u.getState();e&&(s.id=e.id,s.email=e.email,s.active=e.active,s.status=e.status,s.group_ids=[e.group_id],s.attribs=e.attribs?JSON.stringify(e.attribs,null,2):"")}else s.id=0,s.email="",s.active=1,s.status=1,s.group_ids=[],s.attribs=""},onConfirm:async()=>{var e;await (null==(e=a.value)?void 0:e.validate());let t={};try{t=s.attribs?JSON.parse(s.attribs):{}}catch(e){return b.v0.error(`${e}`,{close:!0}),!1}await U({id:s.id,active:s.active,status:s.status,attribs:JSON.stringify(t)}),u.getState().refresh()}});return(e,t)=>{let u=H.Z,n=I.ZP,p=W.Z,d=M.Z,m=N.ZP,v=C.Z;return(0,c.wg)(),(0,c.j4)((0,c.SU)(r),{title:e.$t("contacts.subscribers.edit.title"),width:"600"},{default:(0,c.w5)(()=>[(0,c._)("div",et,[(0,c.Wm)(v,{ref_key:"formRef",ref:a,model:(0,c.SU)(s),rules:l},{default:(0,c.w5)(()=>[(0,c.Wm)(d,{cols:12,"x-gap":24},{default:(0,c.w5)(()=>[(0,c.Wm)(n,{span:8,label:e.$t("contacts.subscribers.edit.email")},{default:(0,c.w5)(()=>[(0,c.Wm)(u,{value:(0,c.SU)(s).email,"onUpdate:value":t[0]||(t[0]=e=>(0,c.SU)(s).email=e),disabled:!0},null,8,["value"])]),_:1},8,["label"]),(0,c.Wm)(n,{span:4,label:e.$t("contacts.subscribers.import.subscriptionStatus")},{default:(0,c.w5)(()=>[(0,c.Wm)(p,{value:(0,c.SU)(s).active,"onUpdate:value":t[1]||(t[1]=e=>(0,c.SU)(s).active=e),options:(0,c.SU)(i)},null,8,["value","options"])]),_:1},8,["label"])]),_:1}),(0,c.Wm)(d,{cols:12,"x-gap":24},{default:(0,c.w5)(()=>[(0,c.Wm)(n,{span:8,label:e.$t("contacts.subscribers.edit.group"),path:"group_ids"},{default:(0,c.w5)(()=>[(0,c.Wm)(G,{value:(0,c.SU)(s).group_ids,"onUpdate:value":t[2]||(t[2]=e=>(0,c.SU)(s).group_ids=e),disabled:!0},null,8,["value"])]),_:1},8,["label"]),(0,c.Wm)(n,{span:4,label:e.$t("contacts.subscribers.import.status")},{default:(0,c.w5)(()=>[(0,c.Wm)(p,{value:(0,c.SU)(s).status,"onUpdate:value":t[3]||(t[3]=e=>(0,c.SU)(s).status=e),options:(0,c.SU)(o)},null,8,["value","options"])]),_:1},8,["label"])]),_:1}),(0,c.Wm)(m,{label:e.$t("contacts.subscribers.edit.attributes")},{default:(0,c.w5)(()=>[(0,c.Wm)(u,{value:(0,c.SU)(s).attribs,"onUpdate:value":t[4]||(t[4]=e=>(0,c.SU)(s).attribs=e),type:"textarea",rows:6},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}});var es=a(65965);let el={class:"w-200px"};function ei(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,c.lA)(e)}let eo=(0,c.aZ)({__name:"index",setup(e){let{t}=(0,Z.QT)(),a=(0,p.tLD)(),_=(0,es.tv)(),w=(0,c.AE)("trendRef"),{tableKeys:S,tableParams:y,tableProps:U,pageProps:W,fetchTable:k,resetTable:$}=(0,f.N)({params:{page:1,page_size:10,group_id:a.value.state.group_id||0,keyword:"",active:-1},fetchFn:h}),R=(0,c.iH)([{type:"selection",width:40},{key:"email",title:t("contacts.subscribers.columns.email"),minWidth:120,ellipsis:{tooltip:!0}},{key:"status",title:"Status",minWidth:100,render:e=>{let a;if(0===e.active){let e;return(0,c.Wm)(d.ZP,{size:"small",type:"error",bordered:!1},ei(e=t("contacts.subscribers.status.unsubscribed"))?e:{default:()=>[e]})}return 1===e.active&&0===e.status?(0,c.Wm)(d.ZP,{size:"small",type:"default",bordered:!1},{default:()=>[(0,c.Uk)("Unconfirmed")]}):(0,c.Wm)(d.ZP,{size:"small",type:"success",bordered:!1},ei(a=t("contacts.subscribers.status.subscribed"))?a:{default:()=>[a]})}},{key:"groups",title:t("contacts.subscribers.joinGroup"),minWidth:100,render:e=>e.group_name||""},{key:"create_time",title:t("contacts.subscribers.columns.createdAt"),minWidth:140,render:e=>(0,b.mr)(e.create_time)},{title:t("common.columns.actions"),key:"actions",align:"right",width:180,render:e=>{let a,s;return(0,c.Wm)(m.Z,{inline:!0},{default:()=>[(0,c.Wm)(v.ZP,{type:"primary",text:!0,onClick:()=>{N(e)}},ei(a=t("common.actions.edit"))?a:{default:()=>[a]}),(0,c.Wm)(v.ZP,{type:"error",text:!0,onClick:()=>{q(e)}},ei(s=t("common.actions.delete"))?s:{default:()=>[s]})]})}}]),P=()=>{$(),(0,c.Y3)(()=>{var e;null==(e=w.value)||e.getData()})},[O,C]=(0,g.d)({component:ee,state:{refresh:k}}),H=()=>{C.setState({group_id:y.value.group_id}),C.open()},T=()=>{if(!y.value.group_id)return void b.v0.warning(t("contacts.subscribers.selectGroupHint"));_.push(`/contacts/settings/${y.value.group_id}`)},[M,I]=(0,g.d)({component:ea,state:{refresh:k}}),N=e=>{I.setState({row:e}),I.open()},q=e=>{(0,b.iG)({title:t("contacts.subscribers.delete.title"),content:t("contacts.subscribers.delete.confirm",{email:e.email}),confirmText:t("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await x({ids:[e.id]}),k()}})},D=()=>{(0,b.iG)({title:"Batch Delete",content:"Are you sure you want to delete the selected subscribers?",confirmText:t("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await x({ids:S.value}),k()}})};return(e,a)=>{let p=n.Z,d=u.Z,m=r.Z,b=o.Z,g=i.Z,f=l.Z,_=s.Z;return(0,c.wg)(),(0,c.iD)("div",null,[(0,c.Wm)(j,{ref_key:"trendRef",ref:w,"group-id":(0,c.SU)(y).group_id,status:(0,c.SU)(y).active},null,8,["group-id","status"]),(0,c.Wm)(_,null,{toolsLeft:(0,c.w5)(()=>[(0,c.Wm)((0,c.SU)(v.ZP),{type:"primary",onClick:H},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)((0,c.SU)(t)("common.actions.import")),1)]),_:1}),(0,c.SU)(y).group_id?((0,c.wg)(),(0,c.j4)((0,c.SU)(v.ZP),{key:0,onClick:T},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)((0,c.SU)(t)("common.actions.settings")),1)]),_:1})):(0,c.kq)("",!0)]),toolsRight:(0,c.w5)(()=>[(0,c.Wm)(d,{value:(0,c.SU)(y).active,"onUpdate:value":[a[0]||(a[0]=e=>(0,c.SU)(y).active=e),(0,c.SU)($)]},{default:(0,c.w5)(()=>[(0,c.Wm)(p,{value:-1},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)((0,c.SU)(t)("common.all.text")),1)]),_:1}),(0,c.Wm)(p,{value:1},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)((0,c.SU)(t)("contacts.subscribers.status.subscribed")),1)]),_:1}),(0,c.Wm)(p,{value:0},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)((0,c.SU)(t)("contacts.subscribers.status.unsubscribed")),1)]),_:1})]),_:1},8,["value","onUpdate:value"]),(0,c._)("div",el,[(0,c.Wm)(z,{value:(0,c.SU)(y).group_id,"onUpdate:value":[a[1]||(a[1]=e=>(0,c.SU)(y).group_id=e),P]},null,8,["value"])]),(0,c.Wm)(m,{value:(0,c.SU)(y).keyword,"onUpdate:value":a[2]||(a[2]=e=>(0,c.SU)(y).keyword=e),width:240,placeholder:(0,c.SU)(t)("contacts.subscribers.search.emailPlaceholder"),onSearch:(0,c.SU)($)},null,8,["value","placeholder","onSearch"])]),table:(0,c.w5)(()=>[(0,c.Wm)(g,(0,c.dG)((0,c.SU)(U),{columns:(0,c.SU)(R)}),{empty:(0,c.w5)(()=>[(0,c.Wm)(b)]),_:1},16,["columns"])]),pageLeft:(0,c.w5)(()=>[(0,c.Wm)((0,c.SU)(v.ZP),{disabled:0===(0,c.SU)(S).length,onClick:D},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)(e.$t("common.actions.delete")),1)]),_:1},8,["disabled"])]),pageRight:(0,c.w5)(()=>[(0,c.Wm)(f,(0,c.dG)((0,c.SU)(W),{onRefresh:(0,c.SU)(k)}),null,16,["onRefresh"])]),modal:(0,c.w5)(()=>[(0,c.Wm)((0,c.SU)(O)),(0,c.Wm)((0,c.SU)(M))]),_:1})])}}}),er=(0,V.default)(eo,[["__scopeId","data-v-eecd7b14"]])}}]);